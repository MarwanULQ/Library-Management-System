import unittest
from src.library_management.services.auth_services import signup, login
from src.library_management.services.database.db import init_db

class TestAuthService(unittest.TestCase):
    @classmethod
    def setUpClass(cls):
        init_db()

    def test_1_signup_success(self):
        user_id = signup("user_test@example.com", "password123")
        self.assertIsNotNone(user_id)

    def test_2_signup_duplicate(self):
        with self.assertRaises(ValueError):
            signup("user_test@example.com", "password123")

    def test_3_login_success(self):
        user_id = login("user_test@example.com", "password123")
        self.assertIsNotNone(user_id)

    def test_4_login_wrong_password(self):
        with self.assertRaises(ValueError):
            login("user_test@example.com", "wrong_pass")

if __name__ == '__main__':
    unittest.main()
